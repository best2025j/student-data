import{r as i,j as e,u}from"./react-vendor-CSMy5Is9.js";import{e as p}from"./vendor-DfK2mEZf.js";const g=({applyFilters:c})=>{const d=[{id:"age",label:"Age",type:"text"},{id:"state",label:"State",type:"text"},{id:"level",label:"Level",type:"text"},{id:"gender",label:"Gender",type:"select",options:[{label:"Male",value:"male"},{label:"Female",value:"female"}]}],[l,n]=i.useState({age:"",state:"",level:"",gender:""}),o=t=>{const{name:a,value:h}=t.target;n(s=>({...s,[a]:h}))},x=t=>{t.preventDefault(),console.log("Filters Applied:",l),c(l)};return e.jsxs("form",{onSubmit:x,className:"gap-4 grid grid-cols-3 items-center py-8 w-full",children:[d.map(t=>e.jsxs("fieldset",{className:"border border-gray-400 px-4 py-2 rounded-md",children:[e.jsx("legend",{className:"text-sm font-semibold text-gray-700 px-2",children:t.label}),t.type==="select"?e.jsxs("select",{id:t.id,name:t.id,value:l[t.id]||"",onChange:o,required:!0,className:"w-full p-1 rounded outline-none",children:[e.jsxs("option",{value:"",children:["Select ",t.label]}),t.options.map((a,h)=>e.jsx("option",{value:a.value,children:a.label},h))]}):e.jsx("input",{type:t.type,id:t.id,name:t.id,value:l[t.id]||"",onChange:o,required:!0,className:"w-full p-1 rounded outline-none"})]},t.id)),e.jsx("div",{className:"pt-3",children:e.jsx("input",{type:"submit",value:"Search",className:"rounded py-4 bg-green-500 text-white w-full hover:bg-green-600 transition"})})]})},j=({students:c,loading:d,error:l})=>{const n=u(),o=t=>{n(`/result/${t.id}`,{state:{student:t}})},x=async t=>{try{const a=await p.post("https://test.omniswift.com.ng/api/viewResult/2",{student_id:t});if(!a.data||!a.data.data){console.error("Invalid response data",a);return}n(`/result/${t}`,{state:{studentData:a.data.data}})}catch(a){console.error("Error fetching student result:",a)}};return e.jsx("div",{className:"w-full px-8 py-3 bg-white",children:d?e.jsxs("p",{className:"text-center flex flex-col justify-center items-center h-[450px] w-full text-blue-500",children:[e.jsxs("svg",{className:"animate-spin h-8 w-8 text-blue-500 mb-2",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v8H4z"})]}),"Loading..."]}):l?e.jsxs("p",{className:"text-center text-red-500",children:["Error: ",l]}):c.length>0?e.jsx("div",{className:"overflow-y-auto w-full h-[450px]",children:e.jsxs("table",{className:"table-fixed w-full border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-200 text-black text-left text-sm font-bold h-14",children:[e.jsx("th",{className:"text-center",children:"S/N"}),e.jsx("th",{children:"Surname"}),e.jsx("th",{children:"First Name"}),e.jsx("th",{children:"Age"}),e.jsx("th",{children:"Gender"}),e.jsx("th",{children:"Level"}),e.jsx("th",{children:"State"}),e.jsx("th",{className:"text-center",children:"Action"})]})}),e.jsx("tbody",{children:c.map((t,a)=>e.jsxs("tr",{onClick:()=>o(t),className:"border-b text-sm border-gray-300 h-14 text-left text-black-10 capitalize cursor-pointer",children:[e.jsx("td",{className:"text-center",children:a+1}),e.jsx("td",{children:t.surname||"N/A"}),e.jsx("td",{children:t.firstname||"N/A"}),e.jsx("td",{children:t.age||"N/A"}),e.jsx("td",{children:t.gender||"N/A"}),e.jsx("td",{children:t.level||"N/A"}),e.jsx("td",{children:t.state||"N/A"}),e.jsx("td",{className:"text-center",children:e.jsx("button",{onClick:()=>x(t.id),className:"bg-green-500 hover:bg-green-600 cursor-pointer transition-all font-normal w-[126px] h-[35px] text-xs text-white rounded",children:"Download File"})})]},a))})]})}):e.jsx("p",{className:"text-center py-4 text-gray-500",children:"No data available"})})},w=()=>{const[c,d]=i.useState([]),[l,n]=i.useState([]),[o,x]=i.useState(!0),[t,a]=i.useState(null);i.useEffect(()=>{(async()=>{try{const r=await(await fetch("https://test.omniswift.com.ng/api/viewAllData")).json();console.log("API Response:",r),d(r.data.students||[]),n(r.data.students||[])}catch(m){console.error("Error fetching data:",m),a("Failed to load data.")}finally{x(!1)}})()},[]);const h=s=>{let m=c.filter(r=>(s.age===""||r.age.toString()===s.age)&&(s.state===""||r.state.toLowerCase().includes(s.state.toLowerCase()))&&(s.level===""||r.level.toLowerCase().includes(s.level.toLowerCase()))&&(s.gender===""||r.gender.toLowerCase()===s.gender.toLowerCase()));n(m)};return e.jsx(e.Fragment,{children:e.jsx("div",{className:"w-[90%] h-full flex-col flex justify-center mx-auto items-start relative top-[30px]",children:e.jsxs("div",{className:"space-y-4 w-full",children:[e.jsx("h1",{className:" text-4xl text-black-10 font-black",children:"Student Data Table"}),e.jsxs("div",{className:"w-full h-[336px] p-8 bg-white ",children:[e.jsx("h1",{className:"text-gray-10",children:"Filter Student Table By:"}),e.jsx(g,{applyFilters:h})]}),e.jsx(j,{students:l,loading:o,error:t})]})})})};export{w as default};
