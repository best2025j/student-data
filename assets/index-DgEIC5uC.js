import{r as d,j as e,u}from"./react-vendor-CSMy5Is9.js";import{e as p}from"./vendor-DfK2mEZf.js";const g=({applyFilters:o})=>{const x=[{id:"age",label:"Age",type:"text"},{id:"state",label:"State",type:"text"},{id:"level",label:"Level",type:"text"},{id:"gender",label:"Gender",type:"select",options:[{label:"Male",value:"male"},{label:"Female",value:"female"}]}],[r,c]=d.useState({age:"",state:"",level:"",gender:""}),i=t=>{const{name:s,value:a}=t.target;c(l=>({...l,[s]:a}))},h=t=>{t.preventDefault(),console.log("Filters Applied:",r),o(r)};return e.jsxs("form",{onSubmit:h,className:"gap-4 grid grid-cols-3 items-center py-8 w-full",children:[x.map(t=>e.jsxs("fieldset",{className:"border border-gray-400 px-4 py-2 rounded-md",children:[e.jsx("legend",{className:"text-sm font-semibold text-gray-700 px-2",children:t.label}),t.type==="select"?e.jsxs("select",{id:t.id,name:t.id,value:r[t.id]||"",onChange:i,required:!0,className:"w-full p-1 rounded outline-none",children:[e.jsxs("option",{value:"",children:["Select ",t.label]}),t.options.map((s,a)=>e.jsx("option",{value:s.value,children:s.label},a))]}):e.jsx("input",{type:t.type,id:t.id,name:t.id,value:r[t.id]||"",onChange:i,required:!0,className:"w-full p-1 rounded outline-none"})]},t.id)),e.jsx("div",{className:"pt-3",children:e.jsx("input",{type:"submit",value:"Search",className:"rounded py-4 bg-green-500 text-white w-full hover:bg-green-600 transition"})})]})},j=({students:o,loading:x,error:r})=>{const c=u(),i=t=>{c(`/result/${t.id}`)},h=async(t,s)=>{t.stopPropagation();try{const a=await p.post("https://test.omniswift.com.ng/api/viewResult/2",{student_id:s});if(!a.data||!a.data.data){console.error("Invalid response data",a);return}c(`/result/${s}`,{state:{studentData:a.data.data}})}catch(a){console.error("Error fetching student result:",a)}};return e.jsx("div",{className:"w-full px-8 py-3 bg-white",children:x?e.jsxs("p",{className:"text-center flex flex-col justify-center items-center h-[450px] w-full text-blue-500",children:[e.jsxs("svg",{className:"animate-spin h-8 w-8 text-blue-500 mb-2",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v8H4z"})]}),"Loading..."]}):r?e.jsxs("p",{className:"text-center text-red-500",children:["Error: ",r]}):o.length>0?e.jsx("div",{className:"overflow-y-auto w-full h-[450px]",children:e.jsxs("table",{className:"table-fixed w-full border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-200 text-black text-left text-sm font-bold h-14",children:[e.jsx("th",{className:"text-center",children:"S/N"}),e.jsx("th",{children:"Surname"}),e.jsx("th",{children:"First Name"}),e.jsx("th",{children:"Age"}),e.jsx("th",{children:"Gender"}),e.jsx("th",{children:"Level"}),e.jsx("th",{children:"State"}),e.jsx("th",{className:"text-center",children:"Action"})]})}),e.jsx("tbody",{children:o.map((t,s)=>e.jsxs("tr",{onClick:()=>i(t),className:"border-b text-sm border-gray-300 h-14 text-left text-black-10 capitalize cursor-copy",children:[e.jsx("td",{className:"text-center",children:s+1}),e.jsx("td",{children:t.surname||"N/A"}),e.jsx("td",{children:t.firstname||"N/A"}),e.jsx("td",{children:t.age||"N/A"}),e.jsx("td",{children:t.gender||"N/A"}),e.jsx("td",{children:t.level||"N/A"}),e.jsx("td",{children:t.state||"N/A"}),e.jsx("td",{className:"text-center",children:e.jsx("button",{onClick:a=>h(a,t.id),className:"bg-green-500 hover:bg-green-600 cursor-pointer transition-all font-normal w-[126px] h-[35px] text-xs text-white rounded",children:"Download File"})})]},t.id||s))})]})}):e.jsx("p",{className:"text-center py-4 text-gray-500",children:"No data available"})})},w=()=>{const[o,x]=d.useState([]),[r,c]=d.useState([]),[i,h]=d.useState(!0),[t,s]=d.useState(null);d.useEffect(()=>{(async()=>{try{const n=await(await fetch("https://test.omniswift.com.ng/api/viewAllData")).json();console.log("API Response:",n),x(n.data.students||[]),c(n.data.students||[])}catch(m){console.error("Error fetching data:",m),s("Failed to load data.")}finally{h(!1)}})()},[]);const a=l=>{let m=o.filter(n=>(l.age===""||n.age.toString()===l.age)&&(l.state===""||n.state.toLowerCase().includes(l.state.toLowerCase()))&&(l.level===""||n.level.toLowerCase().includes(l.level.toLowerCase()))&&(l.gender===""||n.gender.toLowerCase()===l.gender.toLowerCase()));c(m)};return e.jsx(e.Fragment,{children:e.jsx("div",{className:"w-[90%] h-full flex-col flex justify-center mx-auto items-start relative top-[30px]",children:e.jsxs("div",{className:"space-y-4 w-full",children:[e.jsx("h1",{className:" text-4xl text-black-10 font-black",children:"Student Data Table"}),e.jsxs("div",{className:"w-full h-[336px] p-8 bg-white ",children:[e.jsx("h1",{className:"text-gray-10",children:"Filter Student Table By:"}),e.jsx(g,{applyFilters:a})]}),e.jsx(j,{students:r,loading:i,error:t})]})})})};export{w as default};
